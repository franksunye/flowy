{"version":3,"file":"flowy.umd.js","sources":["../src/flowy.js"],"sourcesContent":["// 导入模块\n// 在浏览器环境中，模块会被自动加载到window对象\n// 在Node.js测试环境中，通过require加载\n// - DomUtils: DOM操作工具\n// - BlockManager: 块管理模块\n\nvar flowy = function(canvas, grab, release, snapping, spacing_x, spacing_y) {\n    if (!grab) {\n        grab = function() {};\n    }\n    if (!release) {\n        release = function() {};\n    }\n    if (!snapping) {\n        snapping = function() {};\n    }\n    if (!spacing_x) {\n        spacing_x = 20;\n    }\n    if (!spacing_y) {\n        spacing_y = 80;\n    }\n    $(document).ready(function() {\n        // 创建块管理器实例\n        var blockManager = (typeof BlockManager !== 'undefined') ? new BlockManager() : null;\n\n        // 保持原有变量作为引用，确保向后兼容\n        var blocks = blockManager ? blockManager.getAllBlocks() : [];\n        var blockstemp = blockManager ? blockManager.getTempBlocks() : [];\n        var canvas_div = canvas;\n\n        // 辅助函数：获取块数量（兼容原有代码）\n        function getBlockCount() {\n            return blockManager ? blockManager.getBlockCount() : blocks.length;\n        }\n\n        // 辅助函数：获取下一个块ID\n        function getNextBlockId() {\n            if (blockManager) {\n                return blockManager.getNextBlockId();\n            } else {\n                return blocks.length === 0 ? 0 : Math.max.apply(Math, blocks.map(a => a.id)) + 1;\n            }\n        }\n\n        // 辅助函数：清空所有块\n        function clearAllBlocks() {\n            if (blockManager) {\n                blockManager.clearBlocks();\n                // 同时清空引用数组以保持同步\n                blocks.length = 0;\n            } else {\n                blocks = [];\n            }\n        }\n\n        // 辅助函数：添加块\n        function addBlock(blockData) {\n            if (blockManager) {\n                blockManager.addBlock(blockData);\n                // 同时添加到引用数组以保持同步\n                blocks.push(blockData);\n            } else {\n                blocks.push(blockData);\n            }\n        }\n\n        // 辅助函数：合并临时块到主数组\n        function mergeTempBlocks() {\n            if (blockManager) {\n                blockManager.mergeTempBlocks();\n                // 同时更新引用数组以保持同步\n                blocks = blockManager.getAllBlocks();\n                blockstemp = blockManager.getTempBlocks();\n            } else {\n                blocks = $.merge(blocks, blockstemp);\n                blockstemp = [];\n            }\n        }\n\n        // 辅助函数：移除指定ID的块\n        function removeBlockById(blockId) {\n            if (blockManager) {\n                blockManager.removeBlocks(function(block) {\n                    return block.id != blockId;\n                });\n                // 同时更新引用数组以保持同步\n                blocks = blockManager.getAllBlocks();\n            } else {\n                blocks = $.grep(blocks, function(e) {\n                    return e.id != blockId;\n                });\n            }\n        }\n        var active = false;\n        var paddingx = spacing_x;\n        var paddingy = spacing_y;\n        var offsetleft = 0;\n        var offsetleftold = 0;\n        var rearrange = false;\n        var lastevent = false;\n        var drag, dragx, dragy, original;\n        // 添加条件检查，确保 canvas_div 存在且有 append 方法\n        if (canvas_div && typeof canvas_div.append === 'function') {\n            canvas_div.append(\"<div class='indicator invisible'></div>\");\n        }\n        flowy.output = function() {\n            var json_data = [];\n            if (blocks.length > 0) {\n                for (var i = 0; i < blocks.length; i++) {\n                    json_data.push({\n                        id: blocks[i].id,\n                        parent: blocks[i].parent,\n                        data: []\n                    });\n                    $(\".blockid[value=\" + blocks[i].id + \"]\").parent().children(\"input\").each(function() {\n                        var json_name = $(this).attr(\"name\");\n                        var json_value = $(this).val();\n                        json_data[i].data.push({\n                            name: json_name,\n                            value: json_value\n                        });\n                    })\n                }\n                return json_data;\n            }\n        }\n        flowy.deleteBlocks = function() {\n            clearAllBlocks();\n            canvas_div.html(\"<div class='indicator invisible'></div>\");\n        }\n        $(document).on(\"mousedown\", \".create-flowy\", function(event) {\n            if (event.which === 1) {\n                original = $(this);\n                if (getBlockCount() == 0) {\n                    var newBlockId = getBlockCount(); // 当blocks为空时，使用0作为第一个ID\n                    $(this).clone().addClass('block').append(\"<input type='hidden' name='blockid' class='blockid' value='\" + newBlockId + \"'>\").removeClass(\"create-flowy\").appendTo(\"body\");\n                    $(this).addClass(\"dragnow\");\n                    drag = $(\".blockid[value=\" + newBlockId + \"]\").parent();\n                } else {\n                    var newBlockId = getNextBlockId();\n                    $(this).clone().addClass('block').append(\"<input type='hidden' name='blockid' class='blockid' value='\" + newBlockId + \"'>\").removeClass(\"create-flowy\").appendTo(\"body\");\n                    $(this).addClass(\"dragnow\");\n                    drag = $(\".blockid[value=\" + newBlockId + \"]\").parent();\n                }\n                blockGrabbed($(this));\n                drag.addClass(\"dragging\");\n                active = true;\n                dragx = event.clientX - $(this).offset().left;\n                dragy = event.clientY - $(this).offset().top;\n                drag.css(\"left\", event.clientX - dragx + \"px\");\n                drag.css(\"top\", event.clientY - dragy + \"px\");\n            }\n        });\n        $(document).on(\"mouseup\", function(event) {\n            if (event.which === 1 && (active || rearrange)) {\n                blockReleased();\n                if (!$(\".indicator\").hasClass(\"invisible\")) {\n                    $(\".indicator\").addClass(\"invisible\");\n                }\n                if (active) {\n                    original.removeClass(\"dragnow\");\n                    drag.removeClass(\"dragging\");\n                }\n                if (parseInt(drag.children(\".blockid\").val()) == 0 && rearrange) {\n                    drag.removeClass(\"dragging\");\n                    rearrange = false;\n                    for (var w = 0; w < blockstemp.length; w++) {\n                        if (blockstemp[w].id != parseInt(drag.children(\".blockid\").val())) {\n                            $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().css(\"left\", $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().offset().left - canvas_div.offset().left + canvas_div.scrollLeft());\n                            $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().css(\"top\", $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().offset().top - canvas_div.offset().top + canvas_div.scrollTop());\n                            $(\".arrowid[value=\" + blockstemp[w].id + \"]\").parent().css(\"left\", $(\".arrowid[value=\" + blockstemp[w].id + \"]\").parent().offset().left - canvas_div.offset().left + canvas_div.scrollLeft());\n                            $(\".arrowid[value=\" + blockstemp[w].id + \"]\").parent().css(\"top\", $(\".arrowid[value=\" + blockstemp[w].id + \"]\").parent().offset().top - canvas_div.offset().top + canvas_div.scrollTop() + \"px\");\n                            $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().appendTo(canvas_div);\n                            $(\".arrowid[value=\" + blockstemp[w].id + \"]\").parent().appendTo(canvas_div);\n\n                            blockstemp[w].x = $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().offset().left + ($(\".blockid[value=\" + blockstemp[w].id + \"]\").innerWidth() / 2) + canvas_div.scrollLeft();\n                            blockstemp[w].y = $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().offset().top + ($(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().innerHeight() / 2) + canvas_div.scrollTop();\n\n                        }\n                    }\n                    blockstemp.filter(a => a.id == 0)[0].x = drag.offset().left + (drag.innerWidth() / 2);\n                    blockstemp.filter(a => a.id == 0)[0].y = drag.offset().top + (drag.innerHeight() / 2);\n                    mergeTempBlocks();\n                } else if (active && blocks.length == 0 && drag.offset().top > canvas_div.offset().top && drag.offset().left > canvas_div.offset().left) {\n                    blockSnap(drag);\n                    active = false;\n                    drag.css(\"top\", drag.offset().top - canvas_div.offset().top + canvas_div.scrollTop() + \"px\");\n                    drag.css(\"left\", drag.offset().left - canvas_div.offset().left + canvas_div.scrollLeft() + \"px\");\n                    drag.appendTo(canvas_div);\n                    addBlock({\n                        parent: -1,\n                        childwidth: 0,\n                        id: parseInt(drag.children(\".blockid\").val()),\n                        x: drag.offset().left + (drag.innerWidth() / 2) + canvas_div.scrollLeft(),\n                        y: drag.offset().top + (drag.innerHeight() / 2) + canvas_div.scrollTop(),\n                        width: drag.innerWidth(),\n                        height: drag.innerHeight()\n                    });\n                } else if (active && blocks.length == 0) {\n                    drag.remove();\n                } else if (active || rearrange) {\n                    var xpos = drag.offset().left + (drag.innerWidth() / 2) + canvas_div.scrollLeft();\n                    var ypos = drag.offset().top + canvas_div.scrollTop();\n                    var blocko = blocks.map(a => a.id);\n                    for (var i = 0; i < blocks.length; i++) {\n                        if (xpos >= blocks.filter(a => a.id == blocko[i])[0].x - (blocks.filter(a => a.id == blocko[i])[0].width / 2) - paddingx && xpos <= blocks.filter(a => a.id == blocko[i])[0].x + (blocks.filter(a => a.id == blocko[i])[0].width / 2) + paddingx && ypos >= blocks.filter(a => a.id == blocko[i])[0].y - (blocks.filter(a => a.id == blocko[i])[0].height / 2) && ypos <= blocks.filter(a => a.id == blocko[i])[0].y + blocks.filter(a => a.id == blocko[i])[0].height) {\n                            active = false;\n                            if (!rearrange) {\n                                blockSnap(drag);\n                                drag.appendTo(canvas_div);\n                            }\n                            var totalwidth = 0;\n                            var totalremove = 0;\n                            var maxheight = 0;\n                            for (var w = 0; w < blocks.filter(id => id.parent == blocko[i]).length; w++) {\n                                var children = blocks.filter(id => id.parent == blocko[i])[w];\n                                if (children.childwidth > children.width) {\n                                    totalwidth += children.childwidth + paddingx;\n                                } else {\n                                    totalwidth += children.width + paddingx;\n                                }\n                            }\n                            totalwidth += drag.innerWidth();\n                            for (var w = 0; w < blocks.filter(id => id.parent == blocko[i]).length; w++) {\n                                var children = blocks.filter(id => id.parent == blocko[i])[w];\n                                if (children.childwidth > children.width) {\n                                    $(\".blockid[value=\" + children.id + \"]\").parent().css(\"left\", blocks.filter(a => a.id == blocko[i])[0].x - (totalwidth / 2) + totalremove + (children.childwidth / 2) - (children.width / 2) + \"px\");\n                                    children.x = blocks.filter(id => id.parent == blocko[i])[0].x - (totalwidth / 2) + totalremove + (children.childwidth / 2);\n                                    totalremove += children.childwidth + paddingx;\n                                } else {\n                                    $(\".blockid[value=\" + children.id + \"]\").parent().css(\"left\", blocks.filter(a => a.id == blocko[i])[0].x - (totalwidth / 2) + totalremove + \"px\");\n                                    children.x = blocks.filter(id => id.parent == blocko[i])[0].x - (totalwidth / 2) + totalremove + (children.width / 2);\n                                    totalremove += children.width + paddingx;\n                                }\n                            }\n                            drag.css(\"left\", blocks.filter(id => id.id == blocko[i])[0].x - (totalwidth / 2) + totalremove - canvas_div.offset().left + canvas_div.scrollLeft() + \"px\");\n                            drag.css(\"top\", blocks.filter(id => id.id == blocko[i])[0].y + (blocks.filter(id => id.id == blocko[i])[0].height / 2) + paddingy - canvas_div.offset().top + \"px\");\n                            if (rearrange) {\n                                blockstemp.filter(a => a.id == parseInt(drag.children(\".blockid\").val()))[0].x = drag.offset().left + (drag.innerWidth() / 2) + canvas_div.scrollLeft() + canvas_div.scrollLeft();\n                                blockstemp.filter(a => a.id == parseInt(drag.children(\".blockid\").val()))[0].y = drag.offset().top + (drag.innerHeight() / 2) + canvas_div.scrollTop();\n                                blockstemp.filter(a => a.id == drag.children(\".blockid\").val())[0].parent = blocko[i];\n                                for (var w = 0; w < blockstemp.length; w++) {\n                                    if (blockstemp[w].id != parseInt(drag.children(\".blockid\").val())) {\n                                        $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().css(\"left\", $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().offset().left - canvas_div.offset().left + canvas_div.scrollLeft());\n                                        $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().css(\"top\", $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().offset().top - canvas_div.offset().top + canvas_div.scrollTop());\n                                        $(\".arrowid[value=\" + blockstemp[w].id + \"]\").parent().css(\"left\", $(\".arrowid[value=\" + blockstemp[w].id + \"]\").parent().offset().left - canvas_div.offset().left + canvas_div.scrollLeft() + 20);\n                                        $(\".arrowid[value=\" + blockstemp[w].id + \"]\").parent().css(\"top\", $(\".arrowid[value=\" + blockstemp[w].id + \"]\").parent().offset().top - canvas_div.offset().top + canvas_div.scrollTop());\n                                        $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().appendTo(canvas_div);\n                                        $(\".arrowid[value=\" + blockstemp[w].id + \"]\").parent().appendTo(canvas_div);\n\n                                        blockstemp[w].x = $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().offset().left + ($(\".blockid[value=\" + blockstemp[w].id + \"]\").innerWidth() / 2) + canvas_div.scrollLeft();\n                                        blockstemp[w].y = $(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().offset().top + ($(\".blockid[value=\" + blockstemp[w].id + \"]\").parent().innerHeight() / 2) + canvas_div.scrollTop();\n\n                                    }\n                                }\n                                mergeTempBlocks();\n                            } else {\n                                addBlock({\n                                    childwidth: 0,\n                                    parent: blocko[i],\n                                    id: parseInt(drag.children(\".blockid\").val()),\n                                    x: drag.offset().left + (drag.innerWidth() / 2) + canvas_div.scrollLeft(),\n                                    y: drag.offset().top + (drag.innerHeight() / 2) + canvas_div.scrollTop(),\n                                    width: drag.innerWidth(),\n                                    height: drag.innerHeight()\n                                });\n                            }\n                            var arrowhelp = blocks.filter(a => a.id == parseInt(drag.children(\".blockid\").val()))[0];\n                            var arrowx = arrowhelp.x - blocks.filter(a => a.id == blocko[i])[0].x + 20;\n                            var arrowy = arrowhelp.y - (arrowhelp.height / 2) - (blocks.filter(id => id.parent == blocko[i])[0].y + (blocks.filter(id => id.parent == blocko[i])[0].height / 2)) + canvas_div.scrollTop();\n                            if (arrowx < 0) {\n                                drag.after('<div class=\"arrowblock\"><input type=\"hidden\" class=\"arrowid\" value=\"' + drag.children(\".blockid\").val() + '\"><svg preserveaspectratio=\"none\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M' + (blocks.filter(a => a.id == blocko[i])[0].x - arrowhelp.x + 5) + ' 0L' + (blocks.filter(a => a.id == blocko[i])[0].x - arrowhelp.x + 5) + ' ' + (paddingy / 2) + 'L5 ' + (paddingy / 2) + 'L5 ' + arrowy + '\" stroke=\"#C5CCD0\" stroke-width=\"2px\"/><path d=\"M0 ' + (arrowy - 5) + 'H10L5 ' + arrowy + 'L0 ' + (arrowy - 5) + 'Z\" fill=\"#C5CCD0\"/></svg></div>');\n                                $('.arrowid[value=' + drag.children(\".blockid\").val() + ']').parent().css(\"left\", (arrowhelp.x - 5) - canvas_div.offset().left + canvas_div.scrollLeft() + \"px\");\n                            } else {\n                                drag.after('<div class=\"arrowblock\"><input type=\"hidden\" class=\"arrowid\" value=\"' + drag.children(\".blockid\").val() + '\"><svg preserveaspectratio=\"none\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M20 0L20 ' + (paddingy / 2) + 'L' + (arrowx) + ' ' + (paddingy / 2) + 'L' + arrowx + ' ' + arrowy + '\" stroke=\"#C5CCD0\" stroke-width=\"2px\"/><path d=\"M' + (arrowx - 5) + ' ' + (arrowy - 5) + 'H' + (arrowx + 5) + 'L' + arrowx + ' ' + arrowy + 'L' + (arrowx - 5) + ' ' + (arrowy - 5) + 'Z\" fill=\"#C5CCD0\"/></svg></div>');\n                                $('.arrowid[value=' + parseInt(drag.children(\".blockid\").val()) + ']').parent().css(\"left\", blocks.filter(a => a.id == blocko[i])[0].x - 20 - canvas_div.offset().left + canvas_div.scrollLeft() + \"px\");\n                            }\n                            $('.arrowid[value=' + parseInt(drag.children(\".blockid\").val()) + ']').parent().css(\"top\", blocks.filter(a => a.id == blocko[i])[0].y + (blocks.filter(a => a.id == blocko[i])[0].height / 2) + \"px\");\n                            if (blocks.filter(a => a.id == blocko[i])[0].parent != -1) {\n                                var flag = false;\n                                var idval = blocko[i];\n                                while (!flag) {\n                                    if (blocks.filter(a => a.id == idval)[0].parent == -1) {\n                                        flag = true;\n                                    } else {\n                                        var zwidth = 0;\n                                        for (var w = 0; w < blocks.filter(id => id.parent == idval).length; w++) {\n                                            var children = blocks.filter(id => id.parent == idval)[w];\n                                            if (children.childwidth > children.width) {\n                                                if (w == blocks.filter(id => id.parent == idval).length - 1) {\n                                                    zwidth += children.childwidth;\n                                                } else {\n                                                    zwidth += children.childwidth + paddingx;\n                                                }\n                                            } else {\n                                                if (w == blocks.filter(id => id.parent == idval).length - 1) {\n                                                    zwidth += children.width;\n                                                } else {\n                                                    zwidth += children.width + paddingx;\n                                                }\n                                            }\n                                        }\n                                        blocks.filter(a => a.id == idval)[0].childwidth = zwidth;\n                                        idval = blocks.filter(a => a.id == idval)[0].parent;\n                                    }\n                                }\n                                blocks.filter(id => id.id == idval)[0].childwidth = totalwidth;\n                            }\n                            if (rearrange) {\n                                rearrange = false;\n                                drag.removeClass(\"dragging\");\n                            }\n                            rearrangeMe();\n                            checkOffset();\n                            break;\n                        } else if (i == blocks.length - 1) {\n                            if (rearrange) {\n                                rearrange = false;\n                                blockstemp = [];\n                            }\n                            active = false;\n                            drag.remove();\n                        }\n                    }\n                }\n            }\n        });\n        $(document).on(\"mousedown\", \".block\", function(event) {\n            $(document).on(\"mouseup mousemove\", \".block\", function handler(event) {\n                if (event.type !== \"mouseup\") {\n                    if (event.which === 1) {\n                        if (!active && !rearrange) {\n                            rearrange = true;\n                            drag = $(this);\n                            drag.addClass(\"dragging\");\n                            dragx = event.clientX - $(this).offset().left;\n                            dragy = event.clientY - $(this).offset().top;\n                            var blockid = parseInt($(this).children(\".blockid\").val());\n                            drag = $(this);\n                            blockstemp.push(blocks.filter(a => a.id == blockid)[0]);\n                            removeBlockById(blockid);\n                            $(\".arrowid[value=\" + blockid + \"]\").parent().remove();\n                            var layer = blocks.filter(a => a.parent == blockid);\n                            var flag = false;\n                            var foundids = [];\n                            var allids = [];\n                            while (!flag) {\n                                for (var i = 0; i < layer.length; i++) {\n                                    blockstemp.push(blocks.filter(a => a.id == layer[i].id)[0]);\n                                    $(\".blockid[value=\" + layer[i].id + \"]\").parent().css(\"left\", $(\".blockid[value=\" + layer[i].id + \"]\").parent().offset().left - drag.offset().left);\n                                    $(\".blockid[value=\" + layer[i].id + \"]\").parent().css(\"top\", $(\".blockid[value=\" + layer[i].id + \"]\").parent().offset().top - drag.offset().top);\n                                    $(\".arrowid[value=\" + layer[i].id + \"]\").parent().css(\"left\", $(\".arrowid[value=\" + layer[i].id + \"]\").parent().offset().left - drag.offset().left);\n                                    $(\".arrowid[value=\" + layer[i].id + \"]\").parent().css(\"top\", $(\".arrowid[value=\" + layer[i].id + \"]\").parent().offset().top - drag.offset().top);\n                                    $(\".blockid[value=\" + layer[i].id + \"]\").parent().appendTo(drag);\n                                    $(\".arrowid[value=\" + layer[i].id + \"]\").parent().appendTo(drag);\n                                    foundids.push(layer[i].id);\n                                    allids.push(layer[i].id);\n                                }\n                                if (foundids.length == 0) {\n                                    flag = true;\n                                } else {\n                                    layer = blocks.filter(a => foundids.includes(a.parent));\n                                    foundids = [];\n                                }\n                            }\n                            for (var i = 0; i < blocks.filter(a => a.parent == blockid).length; i++) {\n                                var blocknumber = blocks.filter(a => a.parent == blockid)[i];\n                                removeBlockById(blocknumber);\n                            }\n                            for (var i = 0; i < allids.length; i++) {\n                                var blocknumber = allids[i];\n                                removeBlockById(blocknumber);\n                            }\n                            if (blocks.length > 1) {\n                                rearrangeMe();\n                            }\n                            if (lastevent) {\n                                fixOffset();\n                            }\n                        }\n                    }\n                }\n                $(document).off(\"mouseup mousemove\", handler);\n            });\n        });\n        $(document).on(\"mousemove\", function(event) {\n            if (active) {\n                drag.css(\"left\", event.clientX - dragx + \"px\");\n                drag.css(\"top\", event.clientY - dragy + \"px\");\n            } else if (rearrange) {\n                drag.css(\"left\", event.clientX - dragx - canvas_div.offset().left + canvas_div.scrollLeft() + \"px\");\n                drag.css(\"top\", event.clientY - dragy - canvas_div.offset().top + canvas_div.scrollTop() + \"px\");\n                blockstemp.filter(a => a.id == parseInt(drag.children(\".blockid\").val())).x = drag.offset().left + (drag.innerWidth() / 2) + canvas_div.scrollLeft();\n                blockstemp.filter(a => a.id == parseInt(drag.children(\".blockid\").val())).y = drag.offset().left + (drag.innerHeight() / 2) + canvas_div.scrollTop();\n            }\n            if (active || rearrange) {\n                var xpos = drag.offset().left + (drag.innerWidth() / 2) + canvas_div.scrollLeft();\n                var ypos = drag.offset().top + canvas_div.scrollTop();\n                var blocko = blocks.map(a => a.id);\n                for (var i = 0; i < blocks.length; i++) {\n                    if (xpos >= blocks.filter(a => a.id == blocko[i])[0].x - (blocks.filter(a => a.id == blocko[i])[0].width / 2) - paddingx && xpos <= blocks.filter(a => a.id == blocko[i])[0].x + (blocks.filter(a => a.id == blocko[i])[0].width / 2) + paddingx && ypos >= blocks.filter(a => a.id == blocko[i])[0].y - (blocks.filter(a => a.id == blocko[i])[0].height / 2) && ypos <= blocks.filter(a => a.id == blocko[i])[0].y + blocks.filter(a => a.id == blocko[i])[0].height) {\n                        $(\".indicator\").appendTo($(\".blockid[value=\" + blocko[i] + \"]\").parent());\n                        $(\".indicator\").css(\"left\", ($(\".blockid[value=\" + blocko[i] + \"]\").parent().innerWidth() / 2) - 5 + \"px\");\n                        $(\".indicator\").css(\"top\", $(\".blockid[value=\" + blocko[i] + \"]\").parent().innerHeight() + \"px\");\n                        $(\".indicator\").removeClass(\"invisible\");\n                        break;\n                    } else if (i == blocks.length - 1) {\n                        if (!$(\".indicator\").hasClass(\"invisible\")) {\n                            $(\".indicator\").addClass(\"invisible\");\n                        }\n                    }\n                }\n            }\n        })\n\n        function checkOffset() {\n            offsetleft = blocks.map(a => a.x);\n            var widths = blocks.map(a => a.width);\n            var mathmin = offsetleft.map(function(item, index) {\n                return item - (widths[index] / 2);\n            })\n            offsetleft = Math.min.apply(Math, mathmin);\n            if (offsetleft < canvas_div.offset().left) {\n                lastevent = true;\n                var blocko = blocks.map(a => a.id);\n                for (var w = 0; w < blocks.length; w++) {\n                    $(\".blockid[value=\" + blocks.filter(a => a.id == blocko[w])[0].id + \"]\").parent().css(\"left\", blocks.filter(a => a.id == blocko[w])[0].x - (blocks.filter(a => a.id == blocko[w])[0].width / 2) - offsetleft + 20);\n                    if (blocks.filter(a => a.id == blocko[w])[0].parent != -1) {\n                        var arrowhelp = blocks.filter(a => a.id == blocko[w])[0];\n                        var arrowx = arrowhelp.x - blocks.filter(a => a.id == blocks.filter(a => a.id == blocko[w])[0].parent)[0].x;\n                        if (arrowx < 0) {\n                            $('.arrowid[value=' + blocko[w] + ']').parent().css(\"left\", (arrowhelp.x - offsetleft + 20 - 5) + \"px\");\n                        } else {\n                            $('.arrowid[value=' + blocko[w] + ']').parent().css(\"left\", blocks.filter(id => id.id == blocks.filter(a => a.id == blocko[w])[0].parent)[0].x - 20 - offsetleft + 20 + \"px\");\n                        }\n                    }\n                }\n                for (var w = 0; w < blocks.length; w++) {\n                    blocks[w].x = $(\".blockid[value=\" + blocks[w].id + \"]\").parent().offset().left + canvas_div.offset().left - ($(\".blockid[value=\" + blocks[w].id + \"]\").parent().innerWidth() / 2) - 40;\n                }\n                offsetleftold = offsetleft;\n            }\n        }\n\n        function fixOffset() {\n            if (offsetleftold < canvas_div.offset().left) {\n                lastevent = false;\n                var blocko = blocks.map(a => a.id);\n                for (var w = 0; w < blocks.length; w++) {\n                    $(\".blockid[value=\" + blocks.filter(a => a.id == blocko[w])[0].id + \"]\").parent().css(\"left\", blocks.filter(a => a.id == blocko[w])[0].x - (blocks.filter(a => a.id == blocko[w])[0].width / 2) - offsetleftold - 20);\n                    blocks.filter(a => a.id == blocko[w])[0].x = $(\".blockid[value=\" + blocks.filter(a => a.id == blocko[w])[0].id + \"]\").parent().offset().left + (blocks.filter(a => a.id == blocko[w])[0].width / 2);\n\n                    if (blocks.filter(a => a.id == blocko[w])[0].parent != -1) {\n                        var arrowhelp = blocks.filter(a => a.id == blocko[w])[0];\n                        var arrowx = arrowhelp.x - blocks.filter(a => a.id == blocks.filter(a => a.id == blocko[w])[0].parent)[0].x;\n                        if (arrowx < 0) {\n                            $('.arrowid[value=' + blocko[w] + ']').parent().css(\"left\", (arrowhelp.x - 5 - canvas_div.offset().left) + \"px\");\n                        } else {\n                            $('.arrowid[value=' + blocko[w] + ']').parent().css(\"left\", blocks.filter(id => id.id == blocks.filter(a => a.id == blocko[w])[0].parent)[0].x - 20 - canvas_div.offset().left + \"px\");\n                        }\n                    }\n                }\n                for (var w = 0; w < blocks.length; w++) {\n                    //blocks[w].x = blocks[w].x+offsetleftold-20;\n                }\n                offsetleftold = 0;\n            }\n        }\n\n        function rearrangeMe() {\n            var result = blocks.map(a => a.parent);\n            for (var z = 0; z < result.length; z++) {\n                if (result[z] == -1) {\n                    z++;\n                }\n                var totalwidth = 0;\n                var totalremove = 0;\n                var maxheight = 0;\n                for (var w = 0; w < blocks.filter(id => id.parent == result[z]).length; w++) {\n                    var children = blocks.filter(id => id.parent == result[z])[w];\n                    if (blocks.filter(id => id.parent == children.id).length == 0) {\n                        children.childwidth = 0;\n                    }\n                    if (children.childwidth > children.width) {\n                        if (w == blocks.filter(id => id.parent == result[z]).length - 1) {\n                            totalwidth += children.childwidth;\n                        } else {\n                            totalwidth += children.childwidth + paddingx;\n                        }\n                    } else {\n                        if (w == blocks.filter(id => id.parent == result[z]).length - 1) {\n                            totalwidth += children.width;\n                        } else {\n                            totalwidth += children.width + paddingx;\n                        }\n                    }\n                }\n                if (result[z] != -1) {\n                    blocks.filter(a => a.id == result[z])[0].childwidth = totalwidth;\n                }\n                for (var w = 0; w < blocks.filter(id => id.parent == result[z]).length; w++) {\n                    var children = blocks.filter(id => id.parent == result[z])[w];\n                    $(\".blockid[value=\" + children.id + \"]\").parent().css(\"top\", blocks.filter(id => id.id == result[z]).y + paddingy + \"px\");\n                    blocks.filter(id => id.id == result[z]).y = blocks.filter(id => id.id == result[z]).y + paddingy;\n                    if (children.childwidth > children.width) {\n                        $(\".blockid[value=\" + children.id + \"]\").parent().css(\"left\", blocks.filter(id => id.id == result[z])[0].x - (totalwidth / 2) + totalremove + (children.childwidth / 2) - (children.width / 2) - canvas_div.offset().left + \"px\");\n                        children.x = blocks.filter(id => id.id == result[z])[0].x - (totalwidth / 2) + totalremove + (children.childwidth / 2);\n                        totalremove += children.childwidth + paddingx;\n                    } else {\n                        $(\".blockid[value=\" + children.id + \"]\").parent().css(\"left\", blocks.filter(id => id.id == result[z])[0].x - (totalwidth / 2) + totalremove - canvas_div.offset().left + \"px\");\n                        children.x = blocks.filter(id => id.id == result[z])[0].x - (totalwidth / 2) + totalremove + (children.width / 2);\n                        totalremove += children.width + paddingx;\n                    }\n                    var arrowhelp = blocks.filter(a => a.id == children.id)[0];\n                    var arrowx = arrowhelp.x - blocks.filter(a => a.id == children.parent)[0].x + 20;\n                    var arrowy = arrowhelp.y - (arrowhelp.height / 2) - (blocks.filter(a => a.id == children.parent)[0].y + (blocks.filter(a => a.id == children.parent)[0].height / 2));\n                    $('.arrowid[value=' + children.id + ']').parent().css(\"top\", blocks.filter(id => id.id == children.parent)[0].y + (blocks.filter(id => id.id == children.parent)[0].height / 2) - canvas_div.offset().top + \"px\");\n                    if (arrowx < 0) {\n                        $('.arrowid[value=' + children.id + ']').parent().css(\"left\", (arrowhelp.x - 5) - canvas_div.offset().left + \"px\");\n                        $('.arrowid[value=' + children.id + ']').parent().html('<input type=\"hidden\" class=\"arrowid\" value=\"' + children.id + '\"><svg preserveaspectratio=\"none\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M' + (blocks.filter(id => id.id == children.parent)[0].x - arrowhelp.x + 5) + ' 0L' + (blocks.filter(id => id.id == children.parent)[0].x - arrowhelp.x + 5) + ' ' + (paddingy / 2) + 'L5 ' + (paddingy / 2) + 'L5 ' + arrowy + '\" stroke=\"#C5CCD0\" stroke-width=\"2px\"/><path d=\"M0 ' + (arrowy - 5) + 'H10L5 ' + arrowy + 'L0 ' + (arrowy - 5) + 'Z\" fill=\"#C5CCD0\"/></svg>');\n                    } else {\n                        $('.arrowid[value=' + children.id + ']').parent().css(\"left\", blocks.filter(id => id.id == children.parent)[0].x - 20 - canvas_div.offset().left + \"px\");\n                        $('.arrowid[value=' + children.id + ']').parent().html('<input type=\"hidden\" class=\"arrowid\" value=\"' + children.id + '\"><svg preserveaspectratio=\"none\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M20 0L20 ' + (paddingy / 2) + 'L' + (arrowx) + ' ' + (paddingy / 2) + 'L' + arrowx + ' ' + arrowy + '\" stroke=\"#C5CCD0\" stroke-width=\"2px\"/><path d=\"M' + (arrowx - 5) + ' ' + (arrowy - 5) + 'H' + (arrowx + 5) + 'L' + arrowx + ' ' + arrowy + 'L' + (arrowx - 5) + ' ' + (arrowy - 5) + 'Z\" fill=\"#C5CCD0\"/></svg>');\n                    }\n                }\n            }\n        }\n    });\n\n    function blockGrabbed(block) {\n        grab(block);\n    }\n\n    function blockReleased() {\n        release();\n    }\n\n    function blockSnap(drag) {\n        snapping(drag);\n    }\n}\n\n// 模块导出支持（用于测试覆盖率追踪）\n// 这不会影响浏览器中的使用，因为 module 在浏览器中未定义\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = flowy;\n}\n"],"names":["flowy","canvas","grab","release","snapping","spacing_x","spacing_y","blockSnap","drag","$","document","ready","blockManager","BlockManager","blocks","getAllBlocks","blockstemp","getTempBlocks","canvas_div","getBlockCount","length","addBlock","blockData","push","mergeTempBlocks","merge","removeBlockById","blockId","removeBlocks","block","id","grep","e","dragx","dragy","original","active","paddingx","paddingy","offsetleft","offsetleftold","rearrange","lastevent","checkOffset","map","a","x","widths","width","mathmin","item","index","Math","min","apply","offset","left","blocko","w","filter","parent","css","arrowhelp","innerWidth","rearrangeMe","result","z","totalwidth","totalremove","children","childwidth","y","arrowx","arrowy","height","top","html","append","output","json_data","i","data","each","json_name","this","attr","json_value","val","name","value","deleteBlocks","clearBlocks","on","event","which","newBlockId","clone","addClass","removeClass","appendTo","getNextBlockId","max","clientX","clientY","hasClass","parseInt","scrollLeft","scrollTop","innerHeight","remove","xpos","ypos","after","flag","idval","zwidth","handler","type","blockid","layer","foundids","allids","includes","fixOffset","off","module","exports"],"mappings":"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"}