# Flowy 产品待办事项列表

## 🎯 产品愿景
将Flowy打造成现代化、高性能、易维护的流程图库

## 📊 当前Sprint状态
- **Sprint 4**: 代码瘦身与架构重构
- **代码行数**: 1245行 (已减少140行)
- **完成任务**: 3个 (1.1, 1.6, 1.2a)

---

## 📋 产品待办事项 (按优先级排序)

### 🔥 当前Sprint (Sprint 4)

#### ✅ 已完成
- **1.1** 移除内联吸附算法 (减少61行)
- **1.6** 清理调试和冗余代码 (减少58行)  
- **1.2a** 移除安全的内联块管理逻辑 (减少21行)

#### 🎯 进行中
- **1.4** 简化模块加载机制
  - **工作量**: 30-45分钟
  - **价值**: 减少代码复杂度
  - **验收标准**: 模块加载逻辑简化，功能保持一致

#### 📋 待办 (按优先级)
1. **1.5** 移除兼容性包装函数 (45-60分钟)
2. **架构解耦任务** (9小时，分6个子任务)
3. **1.3** 提取重排算法模块 (2-2.5小时)
4. **1.7** 功能验证和测试 (30分钟)

---

## 🏗️ 架构解耦计划 (ADR-001)

### 目标
解决拖拽逻辑与块管理的紧密耦合问题

### 实施计划 (6个子任务)
1. **1.2b-1** 创建拖拽状态管理器 (1小时)
2. **1.2b-2** 创建位置计算服务 (1.5小时)
3. **1.2b-3** 创建拖拽控制器 (2小时)
4. **1.2b-4** 重构主文件拖拽事件处理 (2小时)
5. **1.2b-5** 创建DOM渲染管理器 (1.5小时)
6. **1.2b-6** 端到端集成测试 (1小时)

### 预期收益
- 减少200-300行代码
- 建立清晰的分层架构
- 提升可维护性和可测试性

---

## 📊 下个Sprint规划

### Sprint 5候选任务
- 完成架构解耦计划
- 修复核心功能缺陷
- 性能优化

---

## 📐 架构决策记录

### ADR-001: 拖拽与块管理解耦架构 (2025-07-24)
- **问题**: 拖拽逻辑与块管理逻辑紧密耦合
- **决策**: 采用四层架构模式 (表现层/业务逻辑层/数据层/基础设施层)
- **状态**: 已批准，等待实施

---

**维护**: 开发团队  
**更新**: 2025-07-24
