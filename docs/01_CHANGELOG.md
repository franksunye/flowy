# 01_CHANGELOG.md - Flowy 变更日志

所有重要的项目变更都会记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布] - 2025-07-22

### 新增 (Added)
- 🏗️ **模块化重构第二阶段完成**
  - ✅ 完成DOM工具模块 (`src/utils/dom-utils.js`)
  - ✅ 完成块管理模块 (`src/core/block-manager.js`)
  - 建立了完整的模块化目录结构 (`src/core/`, `src/utils/`, `src/api/`)
  - 封装了所有jQuery操作接口和blocks数组管理
- 📚 **现代化文档体系**
  - 全面更新了README.md，增加现代化特性说明
  - 更新了产品待办事项 (`00_BACKLOG.md`)
  - 同步了变更日志 (`01_CHANGELOG.md`)
  - 完善了重构计划文档 (`REFACTORING_PLAN.md`)
  - 更新了重构进度报告 (`REFACTORING_PROGRESS.md`)
  - 建立了验证清单 (`VERIFICATION_CHECKLIST.md`)
- 🚀 **现代化构建系统**
  - 完整的Vite构建配置，支持ES、UMD、IIFE三种格式
  - 开发服务器配置，支持热模块替换(HMR)
  - 源码映射和代码压缩优化
- 🧪 **测试驱动重构流程**
  - 建立了基准测试验证机制
  - 实现了零功能影响重构策略
  - 完整的Jest单元测试框架
  - 创建了隔离测试环境 (`IsolatedFlowyTestEnvironment`)
  - 添加了83个单元测试，覆盖所有核心功能
- 🔧 **代码质量工具**
  - ESLint配置用于代码质量检查
  - Prettier配置用于代码格式化
  - EditorConfig用于编辑器一致性

### 改进 (Changed)
- 🏗️ **架构现代化**
  - 从单体文件架构转向模块化架构
  - 保持100%向后兼容的API
  - 提升了代码可维护性和可测试性
- ⚡ **性能优化**
  - 重构了测试架构，消除了测试间依赖
  - 优化了测试执行效率，平均每测试 < 200ms
  - 改进了错误处理和边界条件测试
- 📖 **文档现代化**
  - 更新了项目介绍，突出现代化特性
  - 增加了详细的安装和使用指南
  - 添加了开发环境设置说明
  - 完善了API参考文档

### 修复 (Fixed)
- 解决了测试间状态污染问题
- 修复了DOM ready回调累积导致的测试失败
- 解决了全局变量冲突问题
- 修复了模块加载顺序问题

### 测试覆盖 (83个测试，100%通过率)
- **API契约测试**: 17个测试 - 验证API稳定性
- **拖拽功能测试**: 17个测试 - 验证拖拽交互
- **吸附算法测试**: 16个测试 - 验证吸附逻辑
- **工作流行为测试**: 19个测试 - 验证工作流完整性
- **隔离环境测试**: 3个测试 - 验证测试环境隔离
- **初始化功能测试**: 11个测试 - 验证初始化过程

### 构建系统特性
- **多格式输出**: ES模块、UMD、IIFE三种格式
- **开发体验**: 热模块替换、快速启动
- **生产优化**: 代码压缩、Tree Shaking、源码映射
- **依赖管理**: 外部依赖处理、全局变量映射

### 技术债务清理
- 删除了损坏的测试文件
- 清理了重复的测试代码
- 移除了临时调试文件
- 统一了代码风格和格式

## [1.0.0] - 原始版本

### 新增 (Added)
- 核心拖拽功能实现
- 吸附算法实现
- 基础API (`flowy.output()`, `flowy.deleteBlocks()`)
- jQuery依赖的DOM操作
- 基础的端到端测试

### 功能特性
- 响应式拖拽
- 自动吸附
- 块重排
- 删除块
- 自动块居中

---

## 版本说明

### 版本号规则
- **主版本号**: 不兼容的API修改
- **次版本号**: 向下兼容的功能性新增
- **修订号**: 向下兼容的问题修正

### 变更类型
- **新增 (Added)**: 新功能
- **改进 (Changed)**: 对现有功能的修改
- **弃用 (Deprecated)**: 即将移除的功能
- **移除 (Removed)**: 已移除的功能
- **修复 (Fixed)**: 错误修复
- **安全 (Security)**: 安全相关修复

---

**维护者**: Flowy开发团队  
**最后更新**: 2025-07-18
